let e,t,i,n,r;($=G||(G={})).moduleId="moduleId",$.serviceId="serviceId",(F=L||(L={}))[F.injectionDecoratorConflict=0]="injectionDecoratorConflict",F[F.missingInjectionDecorator=1]="missingInjectionDecorator",F[F.planning=2]="planning",F[F.resolution=3]="resolution",F[F.unknown=4]="unknown",(T=W||(W={}))[T.unknown=32]="unknown",(_=H||(H={})).id="id",_.moduleId="moduleId",_.serviceId="serviceId",(U=X||(X={})).moduleId="moduleId",U.serviceId="serviceId",(V=J||(J={}))[V.multipleInjection=0]="multipleInjection",V[V.singleInjection=1]="singleInjection",V[V.unmanaged=2]="unmanaged",(K=Q||(Q={}))[K.method=0]="method",K[K.parameter=1]="parameter",K[K.property=2]="property",(z=Y||(Y={}))[z.multipleInjection=0]="multipleInjection",z[z.singleInjection=1]="singleInjection";let o=Symbol.for("@inversifyjs/core/LazyPlanServiceNode"),s=class{[o];_serviceIdentifier;_serviceNode;constructor(e,t){this[o]=!0,this._serviceNode=e,this._serviceIdentifier=t}get bindings(){return this._getNode().bindings}get isContextFree(){return this._getNode().isContextFree}get serviceIdentifier(){return this._serviceIdentifier}set bindings(e){this._getNode().bindings=e}set isContextFree(e){this._getNode().isContextFree=e}static is(e){return"object"==typeof e&&null!==e&&!0===e[o]}invalidate(){this._serviceNode=void 0}isExpanded(){return void 0!==this._serviceNode}_getNode(){return void 0===this._serviceNode&&(this._serviceNode=this._buildPlanServiceNode()),this._serviceNode}};(q=Z||(Z={})).bindingAdded="bindingAdded",q.bindingRemoved="bindingRemoved";let a=Symbol.for("@inversifyjs/plugin/isPlugin"),c=class{[a]=!0;_container;_context;constructor(e,t){this._container=e,this._context=t}};function d(e){return("object"==typeof e&&null!==e||"function"==typeof e)&&"function"==typeof e.then}function l(e){switch(typeof e){case"string":case"symbol":return e.toString();case"function":return e.name;default:throw Error(`Unexpected ${typeof e} service id type`)}}let u=Symbol.for("@inversifyjs/common/islazyServiceIdentifier");class h{[u];#e;constructor(e){this.#e=e,this[u]=!0}static is(e){return"object"==typeof e&&null!==e&&!0===e[u]}unwrap(){return this.#e()}}var f,v,g,p,y,m,b,w,I,S,C,A,j,M,x,B,R,N,O,P,k,D,E,$,F,T,_,U,V,K,z,q,G,L,W,H,X,J,Q,Y,Z,ee,et,ei,en,er,eo,es,ea,ec,ed,el,eu="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof global?global:"u">typeof self?self:{};function eh(e,t,i){return Reflect.getOwnMetadata(t,e,i)}function ef(e,t,i,n){Reflect.defineMetadata(t,i,e,n)}function ev(e,t,i,n,r){let o=n(eh(e,t,r)??i());Reflect.defineMetadata(t,o,e,r)}function eg(e){return Object.getPrototypeOf(e.prototype)?.constructor}ee||(ee=1,v=f||(f={}),function(e){var t="object"==typeof globalThis?globalThis:"object"==typeof eu?eu:"object"==typeof self?self:"object"==typeof this?this:function(){throw ReferenceError("globalThis could not be found. Please polyfill globalThis before loading this module.")}(),i=n(v);function n(e,t){return function(i,n){Object.defineProperty(e,i,{configurable:!0,writable:!0,value:n}),t&&t(i,n)}}"u">typeof t.Reflect&&(i=n(t.Reflect,i)),e(i,t),typeof t.Reflect>"u"&&(t.Reflect=v)}(function(e,t){var i,n="function"==typeof Symbol,r=n&&"u">typeof Symbol.toPrimitive?Symbol.toPrimitive:N("Symbol.toPrimitive not found."),o=n&&"u">typeof Symbol.iterator?Symbol.iterator:N("Symbol.iterator not found."),s=Object.getPrototypeOf(Function),a="function"==typeof Map&&"function"==typeof Map.prototype.entries?Map:N("A valid Map constructor could not be found."),c="function"==typeof Set&&"function"==typeof Set.prototype.entries?Set:N("A valid Set constructor could not be found."),d="function"==typeof WeakMap?WeakMap:N("A valid WeakMap constructor could not be found."),l=n?Symbol.for("@reflect-metadata:registry"):void 0,u=(!m(l)&&w(t.Reflect)&&Object.isExtensible(t.Reflect)&&(i=t.Reflect[l]),m(i)&&(i=function(){!(!m(l)&&"u">typeof t.Reflect)||l in t.Reflect||"function"!=typeof t.Reflect.defineMetadata||(i=(e=t.Reflect).defineMetadata,n=e.hasOwnMetadata,r=e.getOwnMetadata,o=e.getOwnMetadataKeys,s=e.deleteMetadata,u=new d,h={isProviderFor:function(e,t){var i=u.get(e);return!!(!m(i)&&i.has(t))||!!o(e,t).length&&(m(i)&&(i=new c,u.set(e,i)),i.add(t),!0)},OrdinaryDefineOwnMetadata:i,OrdinaryHasOwnMetadata:n,OrdinaryGetOwnMetadata:r,OrdinaryOwnMetadataKeys:o,OrdinaryDeleteMetadata:s});var e,i,n,r,o,s,u,h,f,v,g,p=new d,y={registerProvider:function(e){if(!Object.isExtensible(y))throw Error("Cannot add provider to a frozen registry.");switch(!0){case h===e:break;case m(f):f=e;break;case f===e:break;case m(v):v=e;break;case v===e:break;default:void 0===g&&(g=new c),g.add(e)}},getProvider:b,setProvider:function(e,t,i){if(!function(e){if(m(e))throw TypeError();return f===e||v===e||!m(g)&&g.has(e)}(i))throw Error("Metadata provider not registered.");var n=b(e,t);if(n!==i){if(!m(n))return!1;var r=p.get(e);m(r)&&(r=new a,p.set(e,r)),r.set(t,i)}return!0}};return y;function b(e,t){var i,n=p.get(e);return m(n)||(i=n.get(t)),m(i)&&(i=function(e,t){if(!m(f)){if(f.isProviderFor(e,t))return f;if(!m(v)){if(v.isProviderFor(e,t))return f;if(!m(g))for(var i=M(g);;){var n=x(i);if(!n)return;var r=n.value;if(r.isProviderFor(e,t))return B(i),r}}}if(!m(h)&&h.isProviderFor(e,t))return h}(e,t),m(i)||(m(n)&&(n=new a,p.set(e,n)),n.set(t,i))),i}}()),!m(l)&&w(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,l,{enumerable:!1,configurable:!1,writable:!1,value:i}),i),h=function(e){var t=new d,i={isProviderFor:function(e,i){var n=t.get(e);return!m(n)&&n.has(i)},OrdinaryDefineOwnMetadata:function(e,t,i,r){n(i,r,!0).set(e,t)},OrdinaryHasOwnMetadata:function(e,t,i){var r=n(t,i,!1);return!m(r)&&!!r.has(e)},OrdinaryGetOwnMetadata:function(e,t,i){var r=n(t,i,!1);if(!m(r))return r.get(e)},OrdinaryOwnMetadataKeys:function(e,t){var i=[],r=n(e,t,!1);if(m(r))return i;for(var o=r.keys(),s=M(o),a=0;;){var c=x(s);if(!c)return i.length=a,i;var d=c.value;try{i[a]=d}catch(e){try{B(s)}finally{throw e}}a++}},OrdinaryDeleteMetadata:function(e,i,r){var o=n(i,r,!1);if(m(o)||!o.delete(e))return!1;if(0===o.size){var s=t.get(i);m(s)||(s.delete(r),0===s.size&&t.delete(s))}return!0}};return u.registerProvider(i),i;function n(n,r,o){var s=t.get(n),c=!1;if(m(s)){if(!o)return;s=new a,t.set(n,s),c=!0}var d=s.get(r);if(m(d)){if(!o)return;if(d=new a,s.set(r,d),!e.setProvider(n,r,i))throw s.delete(r),c&&t.delete(n),Error("Wrong provider for target.")}return d}}(u);function f(e,t,i){var n=O(t,i,!1);return!m(n)&&!!n.OrdinaryHasOwnMetadata(e,t,i)}function v(e,t,i){var n=O(t,i,!1);if(!m(n))return n.OrdinaryGetOwnMetadata(e,t,i)}function g(e,t,i,n){O(i,n,!0).OrdinaryDefineOwnMetadata(e,t,i,n)}function p(e,t){var i=O(e,t,!1);return i?i.OrdinaryOwnMetadataKeys(e,t):[]}function y(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function m(e){return void 0===e}function b(e){return null===e}function w(e){return"object"==typeof e?null!==e:"function"==typeof e}e("decorate",function(e,t,i,n){if(m(i)){if(!S(e)||!A(t))throw TypeError();for(var r=e,o=t,s=r.length-1;s>=0;--s){var a=(0,r[s])(o);if(!m(a)&&!b(a)){if(!A(a))throw TypeError();o=a}}return o}if(!S(e)||!w(t)||!w(n)&&!m(n)&&!b(n))throw TypeError();return b(n)&&(n=void 0),function(e,t,i,n){for(var r=e.length-1;r>=0;--r){var o=(0,e[r])(t,i,n);if(!m(o)&&!b(o)){if(!w(o))throw TypeError();n=o}}return n}(e,t,i=I(i),n)}),e("metadata",function(e,t){return function(i,n){if(!w(i)||!m(n)&&!function(e){switch(y(e)){case 3:case 4:return!0;default:return!1}}(n))throw TypeError();g(e,t,i,n)}}),e("defineMetadata",function(e,t,i,n){if(!w(i))throw TypeError();return m(n)||(n=I(n)),g(e,t,i,n)}),e("hasMetadata",function(e,t,i){if(!w(t))throw TypeError();return m(i)||(i=I(i)),function e(t,i,n){if(f(t,i,n))return!0;var r=R(i);return!b(r)&&e(t,r,n)}(e,t,i)}),e("hasOwnMetadata",function(e,t,i){if(!w(t))throw TypeError();return m(i)||(i=I(i)),f(e,t,i)}),e("getMetadata",function(e,t,i){if(!w(t))throw TypeError();return m(i)||(i=I(i)),function e(t,i,n){if(f(t,i,n))return v(t,i,n);var r=R(i);if(!b(r))return e(t,r,n)}(e,t,i)}),e("getOwnMetadata",function(e,t,i){if(!w(t))throw TypeError();return m(i)||(i=I(i)),v(e,t,i)}),e("getMetadataKeys",function(e,t){if(!w(e))throw TypeError();return m(t)||(t=I(t)),function e(t,i){var n=p(t,i),r=R(t);if(null===r)return n;var o=e(r,i);if(o.length<=0)return n;if(n.length<=0)return o;for(var s=new c,a=[],d=0;d<n.length;d++){var l=n[d],u=s.has(l);u||(s.add(l),a.push(l))}for(var h=0;h<o.length;h++){var l=o[h],u=s.has(l);u||(s.add(l),a.push(l))}return a}(e,t)}),e("getOwnMetadataKeys",function(e,t){if(!w(e))throw TypeError();return m(t)||(t=I(t)),p(e,t)}),e("deleteMetadata",function(e,t,i){if(!w(t))throw TypeError();m(i)||(i=I(i));var n=O(t,i,!1);return!m(n)&&n.OrdinaryDeleteMetadata(e,t,i)});function I(e){var t=function(e,t){switch(y(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var i=j(e,r);if(void 0!==i){var n=i.call(e,"string");if(w(n))throw TypeError();return n}return function(e,t){var i,n,r=e.toString;if(C(r)){var n=r.call(e);if(!w(n))return n}var i=e.valueOf;if(C(i)){var n=i.call(e);if(!w(n))return n}throw TypeError()}(e)}(e);return"symbol"==typeof t?t:""+t}function S(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function C(e){return"function"==typeof e}function A(e){return"function"==typeof e}function j(e,t){var i=e[t];if(null!=i){if(!C(i))throw TypeError();return i}}function M(e){var t=j(e,o);if(!C(t))throw TypeError();var i=t.call(e);if(!w(i))throw TypeError();return i}function x(e){var t=e.next();return!t.done&&t}function B(e){var t=e.return;t&&t.call(e)}function R(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===s||t!==s)return t;var i=e.prototype,n=i&&Object.getPrototypeOf(i);if(null==n||n===Object.prototype)return t;var r=n.constructor;return"function"!=typeof r||r===e?t:r}function N(e){throw e}function O(e,t,i){var n=u.getProvider(e,t);if(!m(n))return n;if(i){if(u.setProvider(e,t,h))return h;throw Error("Illegal state.")}}}));let ep="@inversifyjs/container/bindingId";function ey(){let e=eh(Object,ep)??0;return e===Number.MAX_SAFE_INTEGER?ef(Object,ep,Number.MIN_SAFE_INTEGER):ev(Object,ep,()=>e,e=>e+1),e}let em={Request:"Request",Singleton:"Singleton",Transient:"Transient"},eb={ConstantValue:"ConstantValue",DynamicValue:"DynamicValue",Factory:"Factory",Instance:"Instance",Provider:"Provider",ResolvedValue:"ResolvedValue",ServiceRedirection:"ServiceRedirection"};function*ew(...e){for(let t of e)yield*t}class eI{#e;#t;#i;constructor(e){for(let t of(this.#e=new Map,this.#t={},Reflect.ownKeys(e)))this.#t[t]=new Map;this.#i=e}add(e,t){for(let i of(this.#n(e).push(t),Reflect.ownKeys(t)))this.#r(i,t[i]).push(e)}clone(){let e=this.#o(),t=this.#s(),i=Reflect.ownKeys(this.#i),n=this._buildNewInstance(this.#i);for(let r of(this.#a(this.#e,n.#e,e,t),i))this.#c(this.#t[r],n.#t[r],e);return n}get(e,t){return this.#t[e].get(t)}getAllKeys(e){return this.#t[e].keys()}removeByRelation(e,t){let i=this.get(e,t);if(void 0!==i)for(let n of new Set(i)){let i=this.#e.get(n);if(void 0===i)throw Error("Expecting model relation, none found");for(let r of i)r[e]===t&&this.#d(n,r);this.#e.delete(n)}}_buildNewInstance(e){return new eI(e)}_cloneModel(e){return e}_cloneRelation(e){return e}#o(){let e=new Map;for(let t of this.#e.keys()){let i=this._cloneModel(t);e.set(t,i)}return e}#s(){let e=new Map;for(let t of this.#e.values())for(let i of t){let t=this._cloneRelation(i);e.set(i,t)}return e}#n(e){let t=this.#e.get(e);return void 0===t&&(t=[],this.#e.set(e,t)),t}#r(e,t){let i=this.#t[e].get(t);return void 0===i&&(i=[],this.#t[e].set(t,i)),i}#l(e,t){let i=t.get(e);if(void 0===i)throw Error("Expecting model to be cloned, none found");return i}#u(e,t){let i=t.get(e);if(void 0===i)throw Error("Expecting relation to be cloned, none found");return i}#c(e,t,i){for(let[n,r]of e){let e=[];for(let t of r)e.push(this.#l(t,i));t.set(n,e)}}#a(e,t,i,n){for(let[r,o]of e){let e=[];for(let t of o)e.push(this.#u(t,n));t.set(this.#l(r,i),e)}}#d(e,t){for(let i of Reflect.ownKeys(t))this.#h(e,i,t[i])}#h(e,t,i){let n=this.#t[t].get(i);if(void 0!==n){let r=n.indexOf(e);-1!==r&&n.splice(r,1),0===n.length&&this.#t[t].delete(i)}}}(p=et||(et={})).moduleId="moduleId",p.serviceId="serviceId";class eS{#e;#t;constructor(e,t){this.#e=t??new eI({moduleId:{isOptional:!0},serviceId:{isOptional:!1}}),this.#t=e}static build(e){return new eS(e)}add(e,t){this.#e.add(e,t)}clone(){return new eS(this.#t,this.#e.clone())}get(e){let t=[],i=this.#e.get(et.serviceId,e);void 0!==i&&t.push(i);let n=this.#t()?.get(e);if(void 0!==n&&t.push(n),0!==t.length)return ew(...t)}removeAllByModuleId(e){this.#e.removeByRelation(et.moduleId,e)}removeAllByServiceId(e){this.#e.removeByRelation(et.serviceId,e)}}let eC="@inversifyjs/core/classMetadataReflectKey";function eA(){return{constructorArguments:[],lifecycle:{postConstructMethodNames:new Set,preDestroyMethodNames:new Set},properties:new Map,scope:void 0}}let ej="@inversifyjs/core/pendingClassMetadataCountReflectKey",eM=Symbol.for("@inversifyjs/core/InversifyCoreError");class ex extends Error{[eM];kind;constructor(e,t,i){super(t,i),this[eM]=!0,this.kind=e}static is(e){return"object"==typeof e&&null!==e&&!0===e[eM]}static isErrorOfKind(e,t){return ex.is(e)&&e.kind===t}}function eB(e){let t,i=eh(e,eC)??eA();if(void 0===(t=eh(e,ej))||0===t)return function(e,t){let i=[];if(t.length<e.length)throw new ex(ei.missingInjectionDecorator,`Found unexpected missing metadata on type "${e.name}". "${e.name}" constructor requires at least ${e.length.toString()} arguments, found ${t.length.toString()} instead.
Are you using @inject, @multiInject or @unmanaged decorators in every non optional constructor argument?

If you're using typescript and want to rely on auto injection, set "emitDecoratorMetadata" compiler option to true`);for(let e=0;e<t.length;++e)void 0===t[e]&&i.push(e);if(i.length>0)throw new ex(ei.missingInjectionDecorator,`Found unexpected missing metadata on type "${e.name}" at constructor indexes "${i.join('", "')}".

Are you using @inject, @multiInject or @unmanaged decorators at those indexes?

If you're using typescript and want to rely on auto injection, set "emitDecoratorMetadata" compiler option to true`)}(e,i.constructorArguments),i;let n=[];for(let t=0;t<i.constructorArguments.length;++t){let r=i.constructorArguments[t];void 0!==r&&r.kind!==en.unknown||n.push(`  - Missing or incomplete metadata for type "${e.name}" at constructor argument with index ${t.toString()}.
Every constructor parameter must be decorated either with @inject, @multiInject or @unmanaged decorator.`)}for(let[t,r]of i.properties)r.kind===en.unknown&&n.push(`  - Missing or incomplete metadata for type "${e.name}" at property "${t.toString()}".
This property must be decorated either with @inject or @multiInject decorator.`);throw 0===n.length?new ex(ei.unknown,`Unexpected class metadata for type "${e.name}" with uncompletion traces.
This might be caused by one of the following reasons:

1. A third party library is targeting inversify reflection metadata.
2. A bug is causing the issue. Consider submiting an issue to fix it.`):new ex(ei.missingInjectionDecorator,`Invalid class metadata at type ${e.name}:

${n.join(`

`)}`)}function eR(e,t){let i=eB(t).scope??e.scope;return{cache:{isRight:!1,value:void 0},id:ey(),implementationType:t,isSatisfiedBy:()=>!0,moduleId:void 0,onActivation:void 0,onDeactivation:void 0,scope:i,serviceIdentifier:t,type:eb.Instance}}function eN(e){return e.isRight?{isRight:!0,value:e.value}:e}(y=ei||(ei={}))[y.injectionDecoratorConflict=0]="injectionDecoratorConflict",y[y.missingInjectionDecorator=1]="missingInjectionDecorator",y[y.planning=2]="planning",y[y.resolution=3]="resolution",y[y.unknown=4]="unknown",(m=en||(en={}))[m.unknown=32]="unknown",(b=er||(er={})).id="id",b.moduleId="moduleId",b.serviceId="serviceId";let eO=class e extends eI{_buildNewInstance(t){return new e(t)}_cloneModel(e){return function(e){switch(e.type){case eb.ConstantValue:case eb.DynamicValue:return{cache:eN(e.cache),id:e.id,isSatisfiedBy:e.isSatisfiedBy,moduleId:e.moduleId,onActivation:e.onActivation,onDeactivation:e.onDeactivation,scope:e.scope,serviceIdentifier:e.serviceIdentifier,type:e.type,value:e.value};case eb.Factory:return{cache:eN(e.cache),factory:e.factory,id:e.id,isSatisfiedBy:e.isSatisfiedBy,moduleId:e.moduleId,onActivation:e.onActivation,onDeactivation:e.onDeactivation,scope:e.scope,serviceIdentifier:e.serviceIdentifier,type:e.type};case eb.Instance:return{cache:eN(e.cache),id:e.id,implementationType:e.implementationType,isSatisfiedBy:e.isSatisfiedBy,moduleId:e.moduleId,onActivation:e.onActivation,onDeactivation:e.onDeactivation,scope:e.scope,serviceIdentifier:e.serviceIdentifier,type:e.type};case eb.Provider:return{cache:eN(e.cache),id:e.id,isSatisfiedBy:e.isSatisfiedBy,moduleId:e.moduleId,onActivation:e.onActivation,onDeactivation:e.onDeactivation,provider:e.provider,scope:e.scope,serviceIdentifier:e.serviceIdentifier,type:e.type};case eb.ResolvedValue:return{cache:eN(e.cache),factory:e.factory,id:e.id,isSatisfiedBy:e.isSatisfiedBy,metadata:e.metadata,moduleId:e.moduleId,onActivation:e.onActivation,onDeactivation:e.onDeactivation,scope:e.scope,serviceIdentifier:e.serviceIdentifier,type:e.type};case eb.ServiceRedirection:return{id:e.id,isSatisfiedBy:e.isSatisfiedBy,moduleId:e.moduleId,serviceIdentifier:e.serviceIdentifier,targetServiceIdentifier:e.targetServiceIdentifier,type:e.type}}}(e)}},eP=class e{#e;#t;#i;constructor(e,t,i){this.#t=i??new eO({id:{isOptional:!1},moduleId:{isOptional:!0},serviceId:{isOptional:!1}}),this.#i=e,this.#e=t}static build(t,i){return new e(t,i)}clone(){return new e(this.#i,this.#e,this.#t.clone())}get(e){let t=this.getNonParentBindings(e)??this.#i()?.get(e);if(void 0!==t)return t;let i=this.#o(e);return void 0===i?i:[i]}*getChained(e){let t=this.getNonParentBindings(e);void 0!==t&&(yield*t);let i=this.#i();if(void 0===i){if(void 0===t){let t=this.#o(e);void 0!==t&&(yield t)}}else yield*i.getChained(e)}getBoundServices(){let e=new Set(this.#t.getAllKeys(er.serviceId)),t=this.#i();if(void 0!==t)for(let i of t.getBoundServices())e.add(i);return e}getById(e){return this.#t.get(er.id,e)??this.#i()?.getById(e)}getByModuleId(e){return this.#t.get(er.moduleId,e)??this.#i()?.getByModuleId(e)}getNonParentBindings(e){return this.#t.get(er.serviceId,e)}getNonParentBoundServices(){return this.#t.getAllKeys(er.serviceId)}removeById(e){this.#t.removeByRelation(er.id,e)}removeAllByModuleId(e){this.#t.removeByRelation(er.moduleId,e)}removeAllByServiceId(e){this.#t.removeByRelation(er.serviceId,e)}set(e){let t={[er.id]:e.id,[er.serviceId]:e.serviceIdentifier};void 0!==e.moduleId&&(t[er.moduleId]=e.moduleId),this.#t.add(e,t)}#o(e){if(void 0===this.#e||"function"!=typeof e)return;let t=eR(this.#e,e);return this.set(t),t}};(w=eo||(eo={})).moduleId="moduleId",w.serviceId="serviceId";let ek=class e{#e;#t;constructor(e,t){this.#e=t??new eI({moduleId:{isOptional:!0},serviceId:{isOptional:!1}}),this.#t=e}static build(t){return new e(t)}add(e,t){this.#e.add(e,t)}clone(){return new e(this.#t,this.#e.clone())}get(e){let t=[],i=this.#e.get(eo.serviceId,e);void 0!==i&&t.push(i);let n=this.#t()?.get(e);if(void 0!==n&&t.push(n),0!==t.length)return ew(...t)}removeAllByModuleId(e){this.#e.removeByRelation(eo.moduleId,e)}removeAllByServiceId(e){this.#e.removeByRelation(eo.serviceId,e)}};function eD(e,t,i,n){let r=Array.isArray(e)?e:[e];if(void 0!==i)if("number"!=typeof i)if(void 0!==n)for(let e of r)e(t,i,n);else Reflect.decorate(r,t.prototype,i);else for(let e of r)e(t,void 0,i);else Reflect.decorate(r,t)}function eE(){return 0}function e$(e){return t=>{void 0!==t&&t.kind===en.unknown&&ev(e,ej,eE,e=>e-1)}}function eF(e,t){return(...i)=>n=>{if(void 0===n)return e(...i);if(n.kind===es.unmanaged)throw new ex(ei.injectionDecoratorConflict,"Unexpected injection found. Multiple @inject, @multiInject or @unmanaged decorators found");return t(n,...i)}}function eT(e){if(e.kind!==en.unknown&&!0!==e.isFromTypescriptParamType)throw new ex(ei.injectionDecoratorConflict,"Unexpected injection found. Multiple @inject, @multiInject or @unmanaged decorators found")}(I=es||(es={}))[I.multipleInjection=0]="multipleInjection",I[I.singleInjection=1]="singleInjection",I[I.unmanaged=2]="unmanaged";let e_=eF(function(e,t,i){return e===es.multipleInjection?{chained:i?.chained??!1,kind:e,name:void 0,optional:!1,tags:new Map,value:t}:{kind:e,name:void 0,optional:!1,tags:new Map,value:t}},function(e,t,i,n){return eT(e),t===es.multipleInjection?{...e,chained:n?.chained??!1,kind:t,value:i}:{...e,kind:t,value:i}});function eU(e,t){return i=>{let n=i.properties.get(t);return i.properties.set(t,e(n)),i}}function eV(e,t,i,n){if(ex.isErrorOfKind(n,ei.injectionDecoratorConflict)){let r=function(e,t,i){if(void 0===i){if(void 0===t)throw new ex(ei.unknown,"Unexpected undefined property and index values");return{kind:ea.property,property:t,targetClass:e.constructor}}return"number"==typeof i?{index:i,kind:ea.parameter,targetClass:e}:{kind:ea.method,method:t,targetClass:e}}(e,t,i);throw new ex(ei.injectionDecoratorConflict,`Unexpected injection error.

Cause:

${n.message}

Details

${function(e){switch(e.kind){case ea.method:return`[class: "${e.targetClass.name}", method: "${e.method.toString()}"]`;case ea.parameter:return`[class: "${e.targetClass.name}", index: "${e.index.toString()}"]`;case ea.property:return`[class: "${e.targetClass.name}", property: "${e.property.toString()}"]`}}(r)}`,{cause:n})}throw n}function eK(e,t){return(i,n,r)=>{try{let o,s,a;void 0===r?(o=ez(e,t),(e,t)=>{ev(e.constructor,eC,eA,eU(o(e),t))})(i,n):"number"==typeof r?(s=ez(e,t),(e,t,i)=>{var n;if("function"!=typeof e||void 0!==t)throw new ex(ei.injectionDecoratorConflict,`Found an @inject decorator in a non constructor parameter.
Found @inject decorator at method "${t?.toString()??""}" at class "${e.constructor.name}"`);ev(e,eC,eA,(n=s(e),e=>{let t=e.constructorArguments[i];return e.constructorArguments[i]=n(t),e}))})(i,n,r):(a=ez(e,t),(e,t,i)=>{if(void 0===i.set)throw new ex(ei.injectionDecoratorConflict,`Found an @inject decorator in a non setter property method.
Found @inject decorator at method "${t.toString()}" at class "${e.constructor.name}"`);ev(e.constructor,eC,eA,eU(a(e),t))})(i,n,r)}catch(e){eV(i,n,r,e)}}}function ez(e,t){return i=>{let n=t(i);return t=>(n(t),e(t))}}function eq(e){return eK(e_(es.singleInjection,e),e$)}(S=ea||(ea={}))[S.method=0]="method",S[S.parameter=1]="parameter",S[S.property=2]="property";let eG="@inversifyjs/core/classIsInjectableFlagReflectKey",eL=[Array,BigInt,Boolean,Function,Number,Object,String];function eW(e){return t=>{let i;(function(e){if(void 0!==eh(e,eG))throw new ex(ei.injectionDecoratorConflict,`Cannot apply @injectable decorator multiple times at class "${e.name}"`);ef(e,eG,!0)})(t),void 0!==(i=eh(t,"design:paramtypes"))&&ev(t,eC,eA,e=>(i.forEach((t,i)=>{void 0!==e.constructorArguments[i]||eL.includes(t)||(e.constructorArguments[i]={isFromTypescriptParamType:!0,kind:es.singleInjection,name:void 0,optional:!1,tags:new Map,value:t})}),e)),void 0!==e&&ev(t,eC,eA,t=>({...t,scope:e}))}}function eH(e,t,i){return e?new Set([...t,...i]):i}function eX(e){return t=>{let i=eB(e.type);ev(t,eC,eA,t=>{let n,r,o;return{constructorArguments:(e.extendConstructorArguments??!0?(n=[...i.constructorArguments],t.constructorArguments.map((e,t)=>{n[t]=e})):n=t.constructorArguments,n),lifecycle:(r=e.lifecycle?.extendPostConstructMethods??!0,o=eH(e.lifecycle?.extendPreDestroyMethods??!0,i.lifecycle.preDestroyMethodNames,t.lifecycle.preDestroyMethodNames),{postConstructMethodNames:eH(r,i.lifecycle.postConstructMethodNames,t.lifecycle.postConstructMethodNames),preDestroyMethodNames:o}),properties:e.extendProperties??!0?new Map(ew(i.properties,t.properties)):t.properties,scope:t.scope}})}}function eJ(e){return t=>{let i=eg(t);if(void 0===i)throw new ex(ei.injectionDecoratorConflict,`Expected base type for type "${t.name}", none found.`);eX({...e,type:i})(t)}}function eQ(e){return t=>{let i=[],n=eg(t);for(;void 0!==n&&n!==Object;){let e=n;i.push(e),n=eg(e)}for(let n of(i.reverse(),i))eX({...e,type:n})(t)}}function eY(e,t){return eK(e_(es.multipleInjection,e,t),e$)}function eZ(e){return t=>{void 0===t&&ev(e,ej,eE,e=>e+1)}}function e0(e){return t=>{let i=t??{kind:en.unknown,name:void 0,optional:!1,tags:new Map};if(i.kind===es.unmanaged)throw new ex(ei.injectionDecoratorConflict,"Unexpected injection found. Found @unmanaged injection with additional @named, @optional, @tagged or @targetName injections");return e(i)}}function e1(e){return eK(e0(t=>{if(void 0!==t.name)throw new ex(ei.injectionDecoratorConflict,"Unexpected duplicated named decorator");return t.name=e,t}),eZ)}function e2(e){if(e.optional)throw new ex(ei.injectionDecoratorConflict,"Unexpected duplicated optional decorator");return e.optional=!0,e}function e3(){return eK(e0(e2),eZ)}function e4(){return(e,t,i)=>{try{ev(e.constructor,eC,eA,e=>{if(e.lifecycle.postConstructMethodNames.has(t))throw new ex(ei.injectionDecoratorConflict,`Unexpected duplicated postConstruct method ${t.toString()}`);return e.lifecycle.postConstructMethodNames.add(t),e})}catch(i){eV(e,t,void 0,i)}}}function e5(){return(e,t,i)=>{try{ev(e.constructor,eC,eA,e=>{if(e.lifecycle.preDestroyMethodNames.has(t))throw new ex(ei.injectionDecoratorConflict,`Unexpected duplicated preDestroy method ${t.toString()}`);return e.lifecycle.preDestroyMethodNames.add(t),e})}catch(i){eV(e,t,void 0,i)}}}function e6(e,t){return eK(e0(i=>{if(i.tags.has(e))throw new ex(ei.injectionDecoratorConflict,"Unexpected duplicated tag decorator with existing tag");return i.tags.set(e,t),i}),eZ)}function e8(){return{kind:es.unmanaged}}let e7=eF(e8,function(e){if(eT(e),void 0!==e.name||e.optional||e.tags.size>0)throw new ex(ei.injectionDecoratorConflict,"Unexpected injection found. Found @unmanaged injection with additional @named, @optional, @tagged or @targetName injections");return e8()});function e9(){return eK(e7(),e$)}function te(e){return e instanceof Error&&(e instanceof RangeError&&/stack space|call stack|too much recursion/i.test(e.message)||"InternalError"===e.name&&/too much recursion/.test(e.message))}(C=ec||(ec={}))[C.multipleInjection=0]="multipleInjection",C[C.singleInjection=1]="singleInjection";let tt=Symbol.for("@inversifyjs/core/LazyPlanServiceNode");class ti{[tt];_serviceIdentifier;_serviceNode;constructor(e,t){this[tt]=!0,this._serviceNode=e,this._serviceIdentifier=t}get bindings(){return this._getNode().bindings}get isContextFree(){return this._getNode().isContextFree}get serviceIdentifier(){return this._serviceIdentifier}set bindings(e){this._getNode().bindings=e}set isContextFree(e){this._getNode().isContextFree=e}static is(e){return"object"==typeof e&&null!==e&&!0===e[tt]}invalidate(){this._serviceNode=void 0}isExpanded(){return void 0!==this._serviceNode}_getNode(){return void 0===this._serviceNode&&(this._serviceNode=this._buildPlanServiceNode()),this._serviceNode}}class tn{#e;constructor(e){this.#e=e}get name(){return this.#e.elem.name}get serviceIdentifier(){return this.#e.elem.serviceIdentifier}get tags(){return this.#e.elem.tags}getAncestor(){if(this.#e.elem.getAncestorsCalled=!0,void 0!==this.#e.previous)return new tn(this.#e.previous)}}function tr(e,t,i){let n=i?.customServiceIdentifier??t.serviceIdentifier,r=(i?.chained===!0?[...e.operations.getBindingsChained(n)]:[...e.operations.getBindings(n)??[]]).filter(e=>e.isSatisfiedBy(t));if(0===r.length&&void 0!==e.autobindOptions&&"function"==typeof n){let i=eR(e.autobindOptions,n);e.operations.setBinding(i),i.isSatisfiedBy(t)&&r.push(i)}return r}class to{last;constructor(e){this.last=e}concat(e){return new to({elem:e,previous:this.last})}[Symbol.iterator](){let e=this.last;return{next:()=>{if(void 0===e)return{done:!0,value:void 0};let t=e.elem;return e=e.previous,{done:!1,value:t}}}}}function ts(e){let t=new Map;return void 0!==e.rootConstraints.tag&&t.set(e.rootConstraints.tag.key,e.rootConstraints.tag.value),new to({elem:{getAncestorsCalled:!1,name:e.rootConstraints.name,serviceIdentifier:e.rootConstraints.serviceIdentifier,tags:t},previous:void 0})}function ta(e){return void 0!==e.redirections}function tc(e,t,i,n){var r;let o=i.elem.serviceIdentifier,s=i.previous?.elem.serviceIdentifier;Array.isArray(e)?function(e,t,i,n,r,o){if(0!==e.length){let t=o[o.length-1]??i,s=`Ambiguous bindings found for service: "${l(t)}".${th(o)}

Registered bindings:

${e.map(e=>(function(e){switch(e.type){case eb.Instance:return`[ type: "${e.type}", serviceIdentifier: "${l(e.serviceIdentifier)}", scope: "${e.scope}", implementationType: "${e.implementationType.name}" ]`;case eb.ServiceRedirection:return`[ type: "${e.type}", serviceIdentifier: "${l(e.serviceIdentifier)}", redirection: "${l(e.targetServiceIdentifier)}" ]`;default:return`[ type: "${e.type}", serviceIdentifier: "${l(e.serviceIdentifier)}", scope: "${e.scope}" ]`}})(e.binding)).join(`
`)}

Trying to resolve bindings for "${tl(i,n)}".${tu(r)}`;throw new ex(ei.planning,s)}t||td(i,n,r,o)}(e,t,o,s,i.elem,n):(r=i.elem,void 0!==e||t||td(o,s,r,n))}function td(e,t,i,n){let r=n[n.length-1]??e,o=`No bindings found for service: "${l(r)}".

Trying to resolve bindings for "${tl(e,t)}".${th(n)}${tu(i)}`;throw new ex(ei.planning,o)}function tl(e,t){return void 0===t?`${l(e)} (Root service)`:l(t)}function tu(e){let t=0===e.tags.size?"":`
- tags:
  - ${[...e.tags.keys()].map(e=>e.toString()).join(`
  - `)}`;return`

Binding constraints:
- service identifier: ${l(e.serviceIdentifier)}
- name: ${e.name?.toString()??"-"}${t}`}function th(e){return 0===e.length?"":`

- service redirections:
  - ${e.map(e=>l(e)).join(`
  - `)}`}function tf(e,t,i){if(Array.isArray(e.bindings)&&1===e.bindings.length){let[n]=e.bindings;return void(ta(n)&&function e(t,i,n,r){if(1===t.redirections.length){let[o]=t.redirections;return void(ta(o)&&e(o,i,n,[...r,o.binding.targetServiceIdentifier]))}tc(t.redirections,i,n,r)}(n,t,i,[n.binding.targetServiceIdentifier]))}tc(e.bindings,t,i,[])}function tv(e){return h.is(e)?e.unwrap():e}function tg(e){return(t,i,n)=>{let r=tv(n.value),o=i.concat({getAncestorsCalled:!1,name:n.name,serviceIdentifier:r,tags:n.tags}),s=new tn(o.last),a=n.kind===es.multipleInjection&&n.chained,c=tr(t,s,{chained:a}),d=[],l={bindings:d,isContextFree:!0,serviceIdentifier:r};if(d.push(...e(t,o,c,l,a)),l.isContextFree=!o.last.elem.getAncestorsCalled,n.kind===es.singleInjection){tf(l,n.optional,o.last);let[e]=d;l.bindings=e}return l}}function tp(e){return(t,i,n)=>{let r=tv(n.value),o=i.concat({getAncestorsCalled:!1,name:n.name,serviceIdentifier:r,tags:n.tags}),s=new tn(o.last),a=n.kind===ec.multipleInjection&&n.chained,c=tr(t,s,{chained:a}),d=[],l={bindings:d,isContextFree:!0,serviceIdentifier:r};if(d.push(...e(t,o,c,l,a)),l.isContextFree=!o.last.elem.getAncestorsCalled,n.kind===ec.singleInjection){tf(l,n.optional,o.last);let[e]=d;l.bindings=e}return l}}function ty(e){let t=(t,i,n)=>{let r={binding:i,classMetadata:t.operations.getClassMetadata(i.implementationType),constructorParams:[],propertyParams:new Map};return e({autobindOptions:t.autobindOptions,node:r,operations:t.operations,servicesBranch:t.servicesBranch},n)},i=(t,i,n)=>e({autobindOptions:t.autobindOptions,node:{binding:i,params:[]},operations:t.operations,servicesBranch:t.servicesBranch},n),n=(e,n,o,s,a)=>{let c=ta(s)?s.binding.targetServiceIdentifier:s.serviceIdentifier;e.servicesBranch.push(c);let d=[];for(let s of o)switch(s.type){case eb.Instance:d.push(t(e,s,n));break;case eb.ResolvedValue:d.push(i(e,s,n));break;case eb.ServiceRedirection:{let t=r(e,n,s,a);d.push(t);break}default:d.push({binding:s})}return e.servicesBranch.pop(),d},r=(e,t,i,r)=>{let o={binding:i,redirections:[]},s=tr(e,new tn(t.last),{chained:r,customServiceIdentifier:i.targetServiceIdentifier});return o.redirections.push(...n(e,t,s,o,r)),o};return n}function tm(e,t,i,n){void 0!==e&&(ti.is(i)&&!i.isExpanded()||i.isContextFree)?t.setPlan(e,{tree:{root:i}}):t.setNonCachedServiceNode(i,n)}class tb extends ti{#e;#t;#i;#o;constructor(e,t,i,n,r){super(r,tv(n.value)),this.#t=t,this.#e=e,this.#i=i,this.#o=n}_buildPlanServiceNode(){return this.#t(this.#e,this.#i,this.#o)}}class tw extends ti{#e;#t;#i;#o;constructor(e,t,i,n,r){super(r,tv(n.value)),this.#e=e,this.#t=t,this.#i=i,this.#o=n}_buildPlanServiceNode(){return this.#t(this.#e,this.#i,this.#o)}}function tI(e,t,i,n){let r,o,s=(r=(t,n,r)=>{if(r.kind===es.unmanaged)return;let o=function(e){let t;if(0===e.tags.size)t=void 0;else{if(1!==e.tags.size)return;{let[i,n]=e.tags.entries().next().value;t={key:i,value:n}}}let i=h.is(e.value)?e.value.unwrap():e.value;return e.kind===es.multipleInjection?{chained:e.chained,isMultiple:!0,name:e.name,optional:e.optional,serviceIdentifier:i,tag:t}:{isMultiple:!1,name:e.name,optional:e.optional,serviceIdentifier:i,tag:t}}(r);if(void 0!==o){let e=t.operations.getPlan(o);if(void 0!==e&&e.tree.root.isContextFree)return e.tree.root}let s=i(t,n,r),a=new tb(t,e,n,r,s);return tm(o,t.operations,a,{bindingConstraintsList:n,chainedBindings:r.kind===es.multipleInjection&&r.chained,optionalBindings:r.optional}),a},(e,t,i)=>{let n=t.classMetadata;for(let[o,s]of n.constructorArguments.entries())t.constructorParams[o]=r(e,i,s);for(let[o,s]of n.properties){let n=r(e,i,s);void 0!==n&&t.propertyParams.set(o,n)}return e.node}),a=(o=(e,i,r)=>{let o=function(e){let t;if(0===e.tags.size)t=void 0;else{if(1!==e.tags.size)return;{let[i,n]=e.tags.entries().next().value;t={key:i,value:n}}}let i=h.is(e.value)?e.value.unwrap():e.value;return e.kind===ec.multipleInjection?{chained:e.chained,isMultiple:!0,name:e.name,optional:e.optional,serviceIdentifier:i,tag:t}:{isMultiple:!1,name:e.name,optional:e.optional,serviceIdentifier:i,tag:t}}(r);if(void 0!==o){let t=e.operations.getPlan(o);if(void 0!==t&&t.tree.root.isContextFree)return t.tree.root}let s=n(e,i,r),a=new tw(e,t,i,r,s);return tm(o,e.operations,a,{bindingConstraintsList:i,chainedBindings:r.kind===ec.multipleInjection&&r.chained,optionalBindings:r.optional}),a},(e,t,i)=>{for(let[n,r]of t.binding.metadata.arguments.entries())t.params[n]=o(e,i,r);return e.node});return(e,t)=>e.node.binding.type===eb.Instance?s(e,e.node,t):a(e,e.node,t)}class tS extends ti{#e;constructor(e,t){super(t,t.serviceIdentifier),this.#e=e}_buildPlanServiceNode(){return tx(this.#e)}}let tC=tg(tM),tA=tp(tM),tj=ty(tI(tC,tA,tC,tA));function tM(e,t,i,n,r){return tj(e,t,i,n,r)}let tx=e=>{let t=ts(e),i=new tn(t.last),n=e.rootConstraints.isMultiple&&e.rootConstraints.chained,r=tr(e,i,{chained:n}),o=[],s={bindings:o,isContextFree:!0,serviceIdentifier:e.rootConstraints.serviceIdentifier};if(o.push(...tj(e,t,r,s,n)),s.isContextFree=!t.last.elem.getAncestorsCalled,!e.rootConstraints.isMultiple){tf(s,e.rootConstraints.isOptional??!1,t.last);let[i]=o;s.bindings=i}return s};(A=ed||(ed={})).bindingAdded="bindingAdded",A.bindingRemoved="bindingRemoved";class tB{#e;#t;#i;constructor(){this.#e=[],this.#t=8,this.#i=1024}*[Symbol.iterator](){let e=0;for(let t of this.#e){let i=t.deref();void 0===i?++e:yield i}this.#e.length>=this.#t&&this.#s(e)&&this.#o(e)}push(e){let t=new WeakRef(e);if(this.#e.push(t),this.#e.length>=this.#t&&this.#e.length%this.#i==0){let e=0;for(let t of this.#e)void 0===t.deref()&&++e;this.#s(e)&&this.#o(e)}}#o(e){let t=Array(this.#e.length-e),i=0;for(let e of this.#e)e.deref()&&(t[i++]=e);this.#e=t}#s(e){return e>=.5*this.#e.length}}let tR=ty(tI(tC,tA,function(e,t,i){return tN(e,t,i)},function(e,t,i){return tO(e,t,i)})),tN=(e=tg(tR),(t,i,n)=>{try{return e(t,i,n)}catch(e){if(ex.isErrorOfKind(e,ei.planning))return;throw e}}),tO=(t=tp(tR),(e,i,n)=>{try{return t(e,i,n)}catch(e){if(ex.isErrorOfKind(e,ei.planning))return;throw e}});function tP(e,t,i,n,r){if(ti.is(t)&&!t.isExpanded())return{isContextFreeBinding:!0,shouldInvalidateServiceNode:!1};let o=new tn(n.last);return!i.isSatisfiedBy(o)||n.last.elem.getAncestorsCalled?{isContextFreeBinding:!n.last.elem.getAncestorsCalled,shouldInvalidateServiceNode:!1}:function(e,t,i,n,r){let o;try{[o]=tR(e,n,[i],t,r)}catch(e){if(te(e))return{isContextFreeBinding:!1,shouldInvalidateServiceNode:!0};throw e}var s=o;if(Array.isArray(t.bindings))t.bindings.push(s);else{if(void 0!==t.bindings){if(!ti.is(t))throw new ex(ei.planning,"Unexpected non-lazy plan service node. This is likely a bug in the planning logic. Please, report this issue");return{isContextFreeBinding:!0,shouldInvalidateServiceNode:!0}}t.bindings=s}return{isContextFreeBinding:!0,shouldInvalidateServiceNode:!1}}(e,t,i,n,r)}function tk(e,t,i,n){let r;if(ti.is(e)&&!e.isExpanded())return{bindingNodeRemoved:void 0,isContextFreeBinding:!0};let o=new tn(i.last);if(!t.isSatisfiedBy(o)||i.last.elem.getAncestorsCalled)return{bindingNodeRemoved:void 0,isContextFreeBinding:!i.last.elem.getAncestorsCalled};if(Array.isArray(e.bindings))e.bindings=e.bindings.filter(e=>e.binding!==t||(r=e,!1));else if(e.bindings?.binding===t)if(r=e.bindings,n)e.bindings=void 0;else{if(!ti.is(e))throw new ex(ei.planning,"Unexpected non-lazy plan service node. This is likely a bug in the planning logic. Please, report this issue");e.invalidate()}return{bindingNodeRemoved:r,isContextFreeBinding:!0}}class tD{#e;#t;#i;#o;#s;#n;constructor(){this.#e=new Map,this.#t=this.#r(),this.#i=this.#r(),this.#o=this.#r(),this.#s=this.#r(),this.#n=new tB}clearCache(){for(let e of this.#a())e.clear();for(let e of this.#n)e.clearCache()}get(e){return void 0===e.name?void 0===e.tag?this.#c(this.#t,e).get(e.serviceIdentifier):this.#c(this.#s,e).get(e.serviceIdentifier)?.get(e.tag.key)?.get(e.tag.value):void 0===e.tag?this.#c(this.#i,e).get(e.serviceIdentifier)?.get(e.name):this.#c(this.#o,e).get(e.serviceIdentifier)?.get(e.name)?.get(e.tag.key)?.get(e.tag.value)}invalidateServiceBinding(e){for(let t of(this.#f(e),this.#h(e),this.#v(e),this.#g(e),this.#p(e),this.#n))t.invalidateServiceBinding(e)}set(e,t){void 0===e.name?void 0===e.tag?this.#c(this.#t,e).set(e.serviceIdentifier,t):this.#u(this.#u(this.#c(this.#s,e),e.serviceIdentifier),e.tag.key).set(e.tag.value,t):void 0===e.tag?this.#u(this.#c(this.#i,e),e.serviceIdentifier).set(e.name,t):this.#u(this.#u(this.#u(this.#c(this.#o,e),e.serviceIdentifier),e.name),e.tag.key).set(e.tag.value,t)}setNonCachedServiceNode(e,t){let i=this.#e.get(e.serviceIdentifier);void 0===i&&(i=new Map,this.#e.set(e.serviceIdentifier,i)),i.set(e,t)}subscribe(e){this.#n.push(e)}#r(){let e=Array(8);for(let t=0;t<e.length;++t)e[t]=new Map;return e}#l(e,t,i,n){let r,o=!!(2&t);return r=o?{chained:!!(0&t),isMultiple:o,serviceIdentifier:e.binding.serviceIdentifier}:{isMultiple:o,serviceIdentifier:e.binding.serviceIdentifier},1&t&&(r.isOptional=!0),void 0!==i&&(r.name=i),void 0!==n&&(r.tag=n),{autobindOptions:void 0,operations:e.operations,rootConstraints:r,servicesBranch:[]}}#u(e,t){let i=e.get(t);return void 0===i&&(i=new Map,e.set(t,i)),i}#c(e,t){return e[this.#d(t)]}#a(){return[this.#e,...this.#t,...this.#i,...this.#o,...this.#s]}#d(e){return e.isMultiple?4*!!e.chained|!!e.optional|2:+!!e.optional}#h(e){for(let[t,i]of this.#i.entries()){let n=i.get(e.binding.serviceIdentifier);if(void 0!==n)for(let[i,r]of n.entries())this.#y(e,r,t,i,void 0)}}#v(e){for(let[t,i]of this.#o.entries()){let n=i.get(e.binding.serviceIdentifier);if(void 0!==n)for(let[i,r]of n.entries())for(let[n,o]of r.entries())for(let[r,s]of o.entries())this.#y(e,s,t,i,{key:n,value:r})}}#m(e){switch(e.binding.type){case eb.ServiceRedirection:for(let t of e.redirections)this.#m(t);break;case eb.Instance:for(let t of e.constructorParams)void 0!==t&&this.#b(t);for(let t of e.propertyParams.values())this.#b(t);break;case eb.ResolvedValue:for(let t of e.params)this.#b(t)}}#b(e){let t=this.#e.get(e.serviceIdentifier);void 0!==t&&t.has(e)&&(t.delete(e),this.#w(e))}#w(e){if((!ti.is(e)||e.isExpanded())&&void 0!==e.bindings)if(Array.isArray(e.bindings))for(let t of e.bindings)this.#m(t);else this.#m(e.bindings)}#p(e){let t=this.#e.get(e.binding.serviceIdentifier);if(void 0!==t)switch(e.kind){case ed.bindingAdded:for(let[i,n]of t){let t=tP({autobindOptions:void 0,operations:e.operations,servicesBranch:[]},i,e.binding,n.bindingConstraintsList,n.chainedBindings);t.isContextFreeBinding?t.shouldInvalidateServiceNode&&ti.is(i)&&(this.#w(i),i.invalidate()):this.clearCache()}break;case ed.bindingRemoved:for(let[i,n]of t){let t=tk(i,e.binding,n.bindingConstraintsList,n.optionalBindings);t.isContextFreeBinding?void 0!==t.bindingNodeRemoved&&this.#m(t.bindingNodeRemoved):this.clearCache()}}}#f(e){for(let[t,i]of this.#t.entries()){let n=i.get(e.binding.serviceIdentifier);this.#y(e,n,t,void 0,void 0)}}#g(e){for(let[t,i]of this.#s.entries()){let n=i.get(e.binding.serviceIdentifier);if(void 0!==n)for(let[i,r]of n.entries())for(let[n,o]of r.entries())this.#y(e,o,t,void 0,{key:i,value:n})}}#y(e,t,i,n,r){var o,s,a,c;if(void 0!==t&&ti.is(t.tree.root)){let d=this.#l(e,i,n,r);switch(e.kind){case ed.bindingAdded:{let i=(o=t.tree.root,s=e.binding,ti.is(o)&&!o.isExpanded()?{isContextFreeBinding:!0,shouldInvalidateServiceNode:!1}:tP(d,o,s,ts(d),d.rootConstraints.isMultiple&&d.rootConstraints.chained));i.isContextFreeBinding?i.shouldInvalidateServiceNode&&(this.#w(t.tree.root),t.tree.root.invalidate()):this.clearCache()}break;case ed.bindingRemoved:{let i=(a=t.tree.root,c=e.binding,ti.is(a)&&!a.isExpanded()?{bindingNodeRemoved:void 0,isContextFreeBinding:!0}:tk(a,c,ts(d),d.rootConstraints.isOptional??!1));i.isContextFreeBinding?void 0!==i.bindingNodeRemoved&&this.#m(i.bindingNodeRemoved):this.clearCache()}}}}}function tE(e,t){return d(t)?(e.cache={isRight:!0,value:t},t.then(t=>t$(e,t))):t$(e,t)}function t$(e,t){return e.cache={isRight:!0,value:t},t}async function tF(e,t,i){let n=await t,r=i.next();for(;!0!==r.done;)n=await r.value(e.context,n),r=i.next();return n}function tT(e,t,i){var n,r;let o,s=i;if(void 0!==t.onActivation){let i=t.onActivation;s=d(s)?s.then(t=>i(e.context,t)):i(e.context,s)}return n=t.serviceIdentifier,r=s,void 0===(o=e.getActivations(n))?r:d(r)?tF(e,r,o[Symbol.iterator]()):function(e,t,i){let n=t,r=i.next();for(;!0!==r.done;){let t=r.value(e.context,n);if(d(t))return tF(e,t,i);n=t,r=i.next()}return n}(e,r,o[Symbol.iterator]())}function t_(e){return(t,i)=>i.cache.isRight?i.cache.value:tE(i,tT(t,i,e(t,i)))}let tU=t_(function(e,t){return t.value});function tV(e,t){return(i,n)=>{let r=e(n);switch(r.scope){case em.Singleton:return r.cache.isRight?r.cache.value:tE(r,tT(i,r,t(i,n)));case em.Request:{if(i.requestScopeCache.has(r.id))return i.requestScopeCache.get(r.id);let e=tT(i,r,t(i,n));return i.requestScopeCache.set(r.id,e),e}case em.Transient:return tT(i,r,t(i,n))}}}let tK=tV(function(e){return e},function(e,t){return t.value(e.context)}),tz=t_(function(e,t){return t.factory(e.context)});function tq(e,t,i){let n=function(e,t,i){if(!(i in e))throw new ex(ei.resolution,`Expecting a "${i.toString()}" property when resolving "${t.implementationType.name}" class @postConstruct decorated method, none found.`);if("function"!=typeof e[i])throw new ex(ei.resolution,`Expecting a "${i.toString()}" method when resolving "${t.implementationType.name}" class @postConstruct decorated method, a non function property was found instead.`);{let n;try{n=e[i]()}catch(e){throw new ex(ei.resolution,`Unexpected error found when calling "${i.toString()}" @postConstruct decorated method on class "${t.implementationType.name}"`,{cause:e})}if(d(n))return async function(e,t,i){try{await i}catch(i){throw new ex(ei.resolution,`Unexpected error found when calling "${t.toString()}" @postConstruct decorated method on class "${e.implementationType.name}"`,{cause:i})}}(t,i,n)}}(e,t,i);return d(n)?n.then(()=>e):e}function tG(e,t,i){if(0===i.size)return e;let n=e;for(let e of i)n=d(n)?n.then(i=>tq(i,t,e)):tq(n,t,e);return n}function tL(e){return(t,i,n)=>{let r=new n.binding.implementationType(...t),o=e(i,r,n);return d(o)?o.then(()=>tG(r,n.binding,n.classMetadata.lifecycle.postConstructMethodNames)):tG(r,n.binding,n.classMetadata.lifecycle.postConstructMethodNames)}}let tW=t_(function(e,t){return t.provider(e.context)}),tH=(j=t1,(e,t,i)=>{let n=[];for(let[r,o]of i.propertyParams){let s=i.classMetadata.properties.get(r);if(void 0===s)throw new ex(ei.resolution,`Expecting metadata at property "${r.toString()}", none found`);s.kind!==es.unmanaged&&void 0!==o.bindings&&(t[r]=j(e,o),d(t[r])&&n.push((async()=>{t[r]=await t[r]})()))}if(n.length>0)return Promise.all(n).then(()=>{})}),tX=(M=t0,function e(t,i){let n=[];for(let r of i.redirections)ta(r)?n.push(...e(t,r)):n.push(M(t,r));return n}),tJ=(x=t1,R=(e,t)=>{let i=[];for(let n of t.constructorParams)void 0===n?i.push(void 0):i.push(x(e,n));return i.some(d)?Promise.all(i):i},B=tL(tH),N=async(e,t,i)=>B(await e,t,i),O=tL(tH),(e,t)=>{let i=R(e,t);return d(i)?N(i,e,t):O(i,e,t)}),tQ=(P=t1,k=(e,t)=>{let i=[];for(let n of t.params)i.push(P(e,n));return i.some(d)?Promise.all(i):i},(e,t)=>{let i=k(e,t);return d(i)?i.then(e=>t.binding.factory(...e)):t.binding.factory(...i)}),tY=tV(function(e){return e.binding},tJ),tZ=tV(function(e){return e.binding},tQ);function t0(e,t){switch(t.binding.type){case eb.ConstantValue:return tU(e,t.binding);case eb.DynamicValue:return tK(e,t.binding);case eb.Factory:return tz(e,t.binding);case eb.Instance:return tY(e,t);case eb.Provider:return tW(e,t.binding);case eb.ResolvedValue:return tZ(e,t)}}function t1(e,t){if(void 0!==t.bindings)return Array.isArray(t.bindings)?function(e,t){let i=[];for(let n of t)ta(n)?i.push(...tX(e,n)):i.push(t0(e,n));return i.some(d)?Promise.all(i):i}(e,t.bindings):function(e,t){if(ta(t)){let i=tX(e,t);if(1===i.length)return i[0];throw new ex(ei.resolution,"Unexpected multiple resolved values on single injection")}return t0(e,t)}(e,t.bindings)}function t2(e,t){if("function"==typeof e[t])return e[t]()}function t3(e,t){let i,n=e.lifecycle.preDestroyMethodNames;if(0!==n.size){for(let e of n)i=void 0===i?t2(t,e):i.then(()=>t2(t,e));return i}}function t4(e,t,i){let n=e.getDeactivations(t);if(void 0!==n)return d(i)?t5(i,n[Symbol.iterator]()):function(e,t){let i=t.next();for(;!0!==i.done;){if(d(i.value(e)))return t5(e,t);i=t.next()}}(i,n[Symbol.iterator]())}async function t5(e,t){let i=await e,n=t.next();for(;!0!==n.done;)await n.value(i),n=t.next()}function t6(e,t){let i=t.cache;return d(i.value)?i.value.then(i=>t8(e,t,i)):t8(e,t,i.value)}function t8(e,t,i){let n;return void 0!==t.onDeactivation&&(n=(0,t.onDeactivation)(i)),void 0===n?t4(e,t.serviceIdentifier,i):n.then(()=>t4(e,t.serviceIdentifier,i))}function t7(e,t){if(void 0===t)return;let i=function(e){let t=[];for(let i of e)void 0!==i.scope&&i.scope===em.Singleton&&i.cache.isRight&&t.push(i);return t}(t),n=[];for(let t of i){let i=function(e,t){let i=function(e,t){if(t.type===eb.Instance){let i=e.getClassMetadata(t.implementationType),n=t.cache.value;return d(n)?n.then(e=>t3(i,e)):t3(i,n)}}(e,t);return void 0===i?t6(e,t):i.then(()=>t6(e,t))}(e,t);void 0!==i&&n.push(i)}return n.length>0?Promise.all(n).then(()=>{}):void 0}let t9="@inversifyjs/container/bindingId";class ie{#e;#t;constructor(e){let t;this.#e=((t=eh(Object,t9)??0)===Number.MAX_SAFE_INTEGER?ef(Object,t9,Number.MIN_SAFE_INTEGER):ev(Object,t9,()=>t,e=>e+1),t),this.#t=e}get id(){return this.#e}load(e){return this.#t(e)}}let it=Symbol.for("@inversifyjs/container/bindingIdentifier");function ii(e){return"object"==typeof e&&null!==e&&!0===e[it]}class ir{static always=e=>!0}let io=Symbol.for("@inversifyjs/container/InversifyContainerError");class is extends Error{[io];kind;constructor(e,t,i){super(t,i),this[io]=!0,this.kind=e}static is(e){return"object"==typeof e&&null!==e&&!0===e[io]}static isErrorOfKind(e,t){return is.is(e)&&e.kind===t}}function ia(e){return{[it]:!0,id:e.id}}function ic(e){return t=>{for(let i=t.getAncestor();void 0!==i;i=i.getAncestor())if(e(i))return!0;return!1}}function id(e){return t=>t.name===e}function il(e){return t=>t.serviceIdentifier===e}function iu(e,t){return i=>i.tags.has(e)&&i.tags.get(e)===t}function ih(e){return void 0===e.name&&0===e.tags.size}function iv(e){let t=ic(e);return e=>!t(e)}function ig(e){return t=>{let i=t.getAncestor();return void 0===i||!e(i)}}function ip(e){return t=>{let i=t.getAncestor();return void 0!==i&&e(i)}}(D=el||(el={}))[D.invalidOperation=0]="invalidOperation";class iy{#e;constructor(e){this.#e=e}getIdentifier(){return ia(this.#e)}inRequestScope(){return this.#e.scope=em.Request,new iI(this.#e)}inSingletonScope(){return this.#e.scope=em.Singleton,new iI(this.#e)}inTransientScope(){return this.#e.scope=em.Transient,new iI(this.#e)}}class im{#e;#t;#i;#o;constructor(e,t,i,n){this.#e=e,this.#t=t,this.#i=i,this.#o=n}to(e){let t=eB(e),i={cache:{isRight:!1,value:void 0},id:ey(),implementationType:e,isSatisfiedBy:ir.always,moduleId:this.#t,onActivation:void 0,onDeactivation:void 0,scope:t.scope??this.#i,serviceIdentifier:this.#o,type:eb.Instance};return this.#e(i),new iS(i)}toSelf(){if("function"!=typeof this.#o)throw Error('"toSelf" function can only be applied when a newable function is used as service identifier');return this.to(this.#o)}toConstantValue(e){let t={cache:{isRight:!1,value:void 0},id:ey(),isSatisfiedBy:ir.always,moduleId:this.#t,onActivation:void 0,onDeactivation:void 0,scope:em.Singleton,serviceIdentifier:this.#o,type:eb.ConstantValue,value:e};return this.#e(t),new iI(t)}toDynamicValue(e){let t={cache:{isRight:!1,value:void 0},id:ey(),isSatisfiedBy:ir.always,moduleId:this.#t,onActivation:void 0,onDeactivation:void 0,scope:this.#i,serviceIdentifier:this.#o,type:eb.DynamicValue,value:e};return this.#e(t),new iS(t)}toResolvedValue(e,t){let i={cache:{isRight:!1,value:void 0},factory:e,id:ey(),isSatisfiedBy:ir.always,metadata:this.#s(t),moduleId:this.#t,onActivation:void 0,onDeactivation:void 0,scope:this.#i,serviceIdentifier:this.#o,type:eb.ResolvedValue};return this.#e(i),new iS(i)}toFactory(e){let t={cache:{isRight:!1,value:void 0},factory:e,id:ey(),isSatisfiedBy:ir.always,moduleId:this.#t,onActivation:void 0,onDeactivation:void 0,scope:em.Singleton,serviceIdentifier:this.#o,type:eb.Factory};return this.#e(t),new iI(t)}toProvider(e){let t={cache:{isRight:!1,value:void 0},id:ey(),isSatisfiedBy:ir.always,moduleId:this.#t,onActivation:void 0,onDeactivation:void 0,provider:e,scope:em.Singleton,serviceIdentifier:this.#o,type:eb.Provider};return this.#e(t),new iI(t)}toService(e){let t={id:ey(),isSatisfiedBy:ir.always,moduleId:this.#t,serviceIdentifier:this.#o,targetServiceIdentifier:e,type:eb.ServiceRedirection};this.#e(t)}#s(e){return{arguments:(e??[]).map(e=>"object"!=typeof e||h.is(e)?{kind:ec.singleInjection,name:void 0,optional:!1,tags:new Map,value:e}:!0===e.isMultiple?{chained:e.chained??!1,kind:ec.multipleInjection,name:e.name,optional:e.optional??!1,tags:new Map((e.tags??[]).map(e=>[e.key,e.value])),value:e.serviceIdentifier}:{kind:ec.singleInjection,name:e.name,optional:e.optional??!1,tags:new Map((e.tags??[]).map(e=>[e.key,e.value])),value:e.serviceIdentifier})}}}class ib{#e;constructor(e){this.#e=e}getIdentifier(){return ia(this.#e)}onActivation(e){return this.#e.onActivation=e,new iw(this.#e)}onDeactivation(e){if(this.#e.onDeactivation=e,this.#e.scope!==em.Singleton)throw new is(el.invalidOperation,`Binding for service "${l(this.#e.serviceIdentifier)}" has a deactivation function, but its scope is not singleton. Deactivation functions can only be used with singleton bindings.`);return new iw(this.#e)}}class iw{#e;constructor(e){this.#e=e}getIdentifier(){return ia(this.#e)}when(e){return this.#e.isSatisfiedBy=e,new ib(this.#e)}whenAnyAncestor(e){return this.when(ic(e))}whenAnyAncestorIs(e){return this.when(ic(il(e)))}whenAnyAncestorNamed(e){return this.when(ic(id(e)))}whenAnyAncestorTagged(e,t){return this.when(ic(iu(e,t)))}whenDefault(){return this.when(ih)}whenNamed(e){return this.when(id(e))}whenNoParent(e){return this.when(ig(e))}whenNoParentIs(e){return this.when(ig(il(e)))}whenNoParentNamed(e){return this.when(ig(id(e)))}whenNoParentTagged(e,t){return this.when(ig(iu(e,t)))}whenParent(e){return this.when(ip(e))}whenParentIs(e){return this.when(ip(il(e)))}whenParentNamed(e){return this.when(ip(id(e)))}whenParentTagged(e,t){return this.when(ip(iu(e,t)))}whenTagged(e,t){return this.when(iu(e,t))}whenNoAncestor(e){return this.when(iv(e))}whenNoAncestorIs(e){return this.when(iv(il(e)))}whenNoAncestorNamed(e){return this.when(iv(id(e)))}whenNoAncestorTagged(e,t){return this.when(iv(iu(e,t)))}}class iI extends iw{#e;constructor(e){super(e),this.#e=new ib(e)}onActivation(e){return this.#e.onActivation(e)}onDeactivation(e){return this.#e.onDeactivation(e)}}class iS extends iI{#e;constructor(e){super(e),this.#e=new iy(e)}inRequestScope(){return this.#e.inRequestScope()}inSingletonScope(){return this.#e.inSingletonScope()}inTransientScope(){return this.#e.inTransientScope()}}class iC{#e;#t;#i;#o;constructor(e,t,i,n){this.#e=e,this.#t=t,this.#i=i,this.#o=n}bind(e){return new im(e=>{this.#s(e)},void 0,this.#t,e)}isBound(e,t){let i=this.#o.bindingService.get(e);return this.#d(e,i,t)}isCurrentBound(e,t){let i=this.#o.bindingService.getNonParentBindings(e);return this.#d(e,i,t)}async rebind(e){return await this.unbind(e),this.bind(e)}rebindSync(e){return this.unbindSync(e),this.bind(e)}async unbind(e){await this.#r(e)}async unbindAll(){let e=[...this.#o.bindingService.getNonParentBoundServices()];for(let t of(await Promise.all(e.map(async e=>{var t;let i;return t=this.#e,i=t.getBindings(e),t7(t,i)})),e))this.#o.activationService.removeAllByServiceId(t),this.#o.bindingService.removeAllByServiceId(t),this.#o.deactivationService.removeAllByServiceId(t);this.#o.planResultCacheService.clearCache()}unbindSync(e){void 0!==this.#r(e)&&this.#n(e)}#s(e){this.#o.bindingService.set(e),this.#i.invalidateService({binding:e,kind:ed.bindingAdded})}#n(e){let t;if(ii(e)){let i=this.#o.bindingService.getById(e.id),n=function(e){if(void 0===e)return;let t=e.next();return!0!==t.done?t.value:void 0}(i?.[Symbol.iterator]())?.serviceIdentifier;t=void 0===n?"Unexpected asynchronous deactivation when unbinding binding identifier. Consider using Container.unbind() instead.":`Unexpected asynchronous deactivation when unbinding "${l(n)}" binding. Consider using Container.unbind() instead.`}else t=`Unexpected asynchronous deactivation when unbinding "${l(e)}" service. Consider using Container.unbind() instead.`;throw new is(el.invalidOperation,t)}#r(e){return ii(e)?this.#l(e):this.#c(e)}#l(e){let t=this.#o.bindingService.getById(e.id),i=void 0===t?void 0:[...t],n=t7(this.#e,t);if(void 0!==n)return n.then(()=>{this.#u(i,e)});this.#u(i,e)}#u(e,t){if(this.#o.bindingService.removeById(t.id),void 0!==e)for(let t of e)this.#i.invalidateService({binding:t,kind:ed.bindingRemoved})}#c(e){let t=this.#o.bindingService.get(e),i=void 0===t?void 0:[...t],n=t7(this.#e,t);if(void 0!==n)return n.then(()=>{this.#a(e,i)});this.#a(e,i)}#a(e,t){if(this.#o.activationService.removeAllByServiceId(e),this.#o.bindingService.removeAllByServiceId(e),this.#o.deactivationService.removeAllByServiceId(e),void 0!==t)for(let e of t)this.#i.invalidateService({binding:e,kind:ed.bindingRemoved})}#d(e,t,i){if(void 0===t)return!1;let n={getAncestor:()=>{},name:i?.name,serviceIdentifier:e,tags:new Map};for(let e of(i?.tag!==void 0&&n.tags.set(i.tag.key,i.tag.value),t))if(e.isSatisfiedBy(n))return!0;return!1}}class iA{#e;#t;#i;#o;#s;constructor(e,t,i,n,r){this.#e=e,this.#t=t,this.#i=i,this.#o=n,this.#s=r}async load(...e){await Promise.all(this.#l(...e))}loadSync(...e){for(let t of this.#l(...e))if(void 0!==t)throw new is(el.invalidOperation,"Unexpected asynchronous module load. Consider using Container.load() instead.")}async unload(...e){await Promise.all(this.#c(...e)),this.#r(e)}unloadSync(...e){for(let t of this.#c(...e))if(void 0!==t)throw new is(el.invalidOperation,"Unexpected asynchronous module unload. Consider using Container.unload() instead.");this.#r(e)}#n(e){return{bind:t=>new im(e=>{this.#u(e)},e,this.#i,t),isBound:this.#e.isBound.bind(this.#e),onActivation:(t,i)=>{this.#s.activationService.add(i,{moduleId:e,serviceId:t})},onDeactivation:(t,i)=>{this.#s.deactivationService.add(i,{moduleId:e,serviceId:t})},rebind:this.#e.rebind.bind(this.#e),rebindSync:this.#e.rebindSync.bind(this.#e),unbind:this.#e.unbind.bind(this.#e),unbindSync:this.#e.unbindSync.bind(this.#e)}}#r(e){for(let t of e)this.#s.activationService.removeAllByModuleId(t.id),this.#s.bindingService.removeAllByModuleId(t.id),this.#s.deactivationService.removeAllByModuleId(t.id);this.#s.planResultCacheService.clearCache()}#l(...e){return e.map(e=>e.load(this.#n(e.id)))}#u(e){this.#s.bindingService.set(e),this.#o.invalidateService({binding:e,kind:ed.bindingAdded})}#c(...e){return e.map(e=>{var t,i;let n;return t=this.#t,i=e.id,n=t.getBindingsFromModule(i),t7(t,n)})}}class ij{deactivationParams;constructor(e){this.deactivationParams={getBindings:e.bindingService.get.bind(e.bindingService),getBindingsFromModule:e.bindingService.getByModuleId.bind(e.bindingService),getClassMetadata:eB,getDeactivations:e.deactivationService.get.bind(e.deactivationService)},e.onReset(()=>{var t;(t=this.deactivationParams).getBindings=e.bindingService.get.bind(e.bindingService),t.getBindingsFromModule=e.bindingService.getByModuleId.bind(e.bindingService),t.getDeactivations=e.deactivationService.get.bind(e.deactivationService)})}}class iM{planParamsOperations;#e;constructor(e){this.#e=e,this.planParamsOperations={getBindings:this.#e.bindingService.get.bind(this.#e.bindingService),getBindingsChained:this.#e.bindingService.getChained.bind(this.#e.bindingService),getClassMetadata:eB,getPlan:this.#e.planResultCacheService.get.bind(this.#e.planResultCacheService),setBinding:this.#i.bind(this),setNonCachedServiceNode:this.#e.planResultCacheService.setNonCachedServiceNode.bind(this.#e.planResultCacheService),setPlan:this.#e.planResultCacheService.set.bind(this.#e.planResultCacheService)},this.#e.onReset(()=>{this.#t()})}#t(){this.planParamsOperations.getBindings=this.#e.bindingService.get.bind(this.#e.bindingService),this.planParamsOperations.getBindingsChained=this.#e.bindingService.getChained.bind(this.#e.bindingService),this.planParamsOperations.setBinding=this.#i.bind(this)}#i(e){this.#e.bindingService.set(e),this.#e.planResultCacheService.invalidateServiceBinding({binding:e,kind:ed.bindingAdded,operations:this.planParamsOperations})}}class ix{#e;#t;constructor(e,t){this.#e=e,this.#t=t}invalidateService(e){this.#t.planResultCacheService.invalidateServiceBinding({...e,operations:this.#e.planParamsOperations})}}class iB{#e;#t;#i;#o;constructor(e,t,i){this.#o=t,this.#i=i,this.#e=this.#s(e),this.#t=this.#n()}register(e,t){let i=new t(e,this.#t);if(!0!==i[a])throw new is(el.invalidOperation,"Invalid plugin. The plugin must extend the Plugin class");i.load(this.#e)}#s(e){return{define:(t,i)=>{if(Object.prototype.hasOwnProperty.call(e,t))throw new is(el.invalidOperation,`Container already has a method named "${String(t)}"`);e[t]=i},onPlan:this.#i.onPlan.bind(this.#i)}}#n(){let e=this.#o;return{get activationService(){return e.activationService},get bindingService(){return e.bindingService},get deactivationService(){return e.deactivationService},get planResultCacheService(){return e.planResultCacheService}}}}class iR{activationService;bindingService;deactivationService;planResultCacheService;#e;constructor(e,t,i,n){this.activationService=e,this.bindingService=t,this.deactivationService=i,this.planResultCacheService=n,this.#e=[]}reset(e,t,i){for(let n of(this.activationService=e,this.bindingService=t,this.deactivationService=i,this.planResultCacheService.clearCache(),this.#e))n()}onReset(e){this.#e.push(e)}}class iN{#e;#t;#i;#o;#s;#n;#r;constructor(e,t,i,n){this.#n=e,this.#r=t,this.#o=this.#h(),this.#e=i,this.#t=n,this.#i=e=>this.#r.activationService.get(e),this.#s=[],this.#r.onReset(()=>{this.#l()})}get(e,t){let i=this.#d(!1,e,t),n=this.#v(i);if(d(n))throw new is(el.invalidOperation,`Unexpected asynchronous service when resolving service "${l(e)}"`);return n}getAll(e,t){let i=this.#d(!0,e,t),n=this.#v(i);if(d(n))throw new is(el.invalidOperation,`Unexpected asynchronous service when resolving service "${l(e)}"`);return n}async getAllAsync(e,t){let i=this.#d(!0,e,t);return this.#v(i)}async getAsync(e,t){let i=this.#d(!1,e,t);return this.#v(i)}onPlan(e){this.#s.push(e)}#l(){this.#o=this.#h()}#u(e,t,i){let n=i?.name,r=i?.optional??!1,o=i?.tag;return e?{chained:i?.chained??!1,isMultiple:e,name:n,optional:r,serviceIdentifier:t,tag:o}:{isMultiple:e,name:n,optional:r,serviceIdentifier:t,tag:o}}#c(e,t,i){let n={autobindOptions:i?.autobind??this.#e?{scope:this.#t}:void 0,operations:this.#n.planParamsOperations,rootConstraints:this.#a(e,t,i),servicesBranch:[]};return this.#m(n,i),n}#a(e,t,i){return t?{chained:i?.chained??!1,isMultiple:t,serviceIdentifier:e}:{isMultiple:t,serviceIdentifier:e}}#d(e,t,i){let n=this.#u(e,t,i),r=this.#r.planResultCacheService.get(n);if(void 0!==r)return r;let o=function(e){try{let t=e.rootConstraints.isMultiple?{chained:e.rootConstraints.chained,isMultiple:!0,name:e.rootConstraints.name,optional:e.rootConstraints.isOptional??!1,serviceIdentifier:e.rootConstraints.serviceIdentifier,tag:e.rootConstraints.tag}:{isMultiple:!1,name:e.rootConstraints.name,optional:e.rootConstraints.isOptional??!1,serviceIdentifier:e.rootConstraints.serviceIdentifier,tag:e.rootConstraints.tag},i=e.operations.getPlan(t);if(void 0!==i)return i;let n=tx(e),r={tree:{root:new tS(e,n)}};return e.operations.setPlan(t,r),r}catch(t){if(te(t)){let i,n=0===(i=[...function(e){let t=new Set;for(let i of e.servicesBranch){if(t.has(i))return[...t,i];t.add(i)}return[...t]}(e)]).length?"(No dependency trace)":i.map(l).join(" -> ");throw new ex(ei.planning,`Circular dependency found: ${n}`,{cause:t})}throw t}}(this.#c(t,e,i));for(let e of this.#s)e(n,o);return o}#h(){return{get:this.get.bind(this),getAll:this.getAll.bind(this),getAllAsync:this.getAllAsync.bind(this),getAsync:this.getAsync.bind(this)}}#v(e){return function(e){try{return t1(e,e.planResult.tree.root)}catch(t){if(te(t)){let i,n,r,o=0===(r=[...(i=e.planResult.tree.root,n=[],function e(t){let i=n.indexOf(t);if(-1!==i)return[...n.slice(i),t].map(e=>e.serviceIdentifier);n.push(t);try{for(let i of function(e){let t=[],i=e.bindings;if(void 0===i)return t;let n=e=>{if(ta(e))for(let t of e.redirections)n(t);else switch(e.binding.type){case eb.Instance:for(let i of e.constructorParams)void 0!==i&&t.push(i);for(let i of e.propertyParams.values())t.push(i);break;case eb.ResolvedValue:for(let i of e.params)t.push(i)}};if(Array.isArray(i))for(let e of i)n(e);else n(i);return t}(t)){let t=e(i);if(void 0!==t)return t}}finally{n.pop()}}(i)??[])]).length?"(No dependency trace)":r.map(l).join(" -> ");throw new ex(ei.planning,`Circular dependency found: ${o}`,{cause:t})}throw t}}({context:this.#o,getActivations:this.#i,planResult:e,requestScopeCache:new Map})}#m(e,t){void 0!==t&&(void 0!==t.name&&(e.rootConstraints.name=t.name),!0===t.optional&&(e.rootConstraints.isOptional=!0),void 0!==t.tag&&(e.rootConstraints.tag={key:t.tag.key,value:t.tag.value}),e.rootConstraints.isMultiple&&(e.rootConstraints.chained=t?.chained??!1))}}class iO{#e;#t;constructor(e){this.#e=e,this.#t=[]}restore(){let e=this.#t.pop();if(void 0===e)throw new is(el.invalidOperation,"No snapshot available to restore");this.#e.reset(e.activationService,e.bindingService,e.deactivationService)}snapshot(){this.#t.push({activationService:this.#e.activationService.clone(),bindingService:this.#e.bindingService.clone(),deactivationService:this.#e.deactivationService.clone()})}}let iP=em.Transient;class ik{#e;#t;#i;#o;#s;#n;constructor(e){let t=e?.autobind??!1,i=e?.defaultScope??iP;this.#o=this.#l(e,t,i);let n=new iM(this.#o),r=new ix(n,this.#o),o=new ij(this.#o);this.#e=new iC(o.deactivationParams,i,r,this.#o),this.#t=new iA(this.#e,o.deactivationParams,i,r,this.#o),this.#s=new iN(n,this.#o,t,i),this.#i=new iB(this,this.#o,this.#s),this.#n=new iO(this.#o)}bind(e){return this.#e.bind(e)}get(e,t){return this.#s.get(e,t)}getAll(e,t){return this.#s.getAll(e,t)}async getAllAsync(e,t){return this.#s.getAllAsync(e,t)}async getAsync(e,t){return this.#s.getAsync(e,t)}isBound(e,t){return this.#e.isBound(e,t)}isCurrentBound(e,t){return this.#e.isCurrentBound(e,t)}async load(...e){return this.#t.load(...e)}loadSync(...e){this.#t.loadSync(...e)}onActivation(e,t){this.#o.activationService.add(t,{serviceId:e})}onDeactivation(e,t){this.#o.deactivationService.add(t,{serviceId:e})}register(e){this.#i.register(this,e)}restore(){this.#n.restore()}async rebind(e){return this.#e.rebind(e)}rebindSync(e){return this.#e.rebindSync(e)}snapshot(){this.#n.snapshot()}async unbind(e){await this.#e.unbind(e)}async unbindAll(){return this.#e.unbindAll()}unbindSync(e){this.#e.unbindSync(e)}async unload(...e){return this.#t.unload(...e)}unloadSync(...e){this.#t.unloadSync(...e)}#r(e,t){if(e)return{scope:t}}#l(e,t,i){let n=this.#r(t,i);if(e?.parent===void 0)return new iR(eS.build(()=>{}),eP.build(()=>{},n),ek.build(()=>{}),new tD);let r=new tD,o=e.parent;return o.#o.planResultCacheService.subscribe(r),new iR(eS.build(()=>o.#o.activationService),eP.build(()=>o.#o.bindingService,n),ek.build(()=>o.#o.deactivationService),r)}}let iD=(E=[[e=>s.is(e),(e,t)=>t({bindings:e.bindings,isContextFree:e.isContextFree,serviceIdentifier:e.serviceIdentifier})]],i=new WeakMap,g=n=function(e){for(let[t,i]of E)if(t(e))return i(e,n);if("function"==typeof e){var t;return{name:(t=e).name,stringifiedContent:t.toString()}}if("object"==typeof e&&null!==e){let t=i.get(e);if(void 0!==t)return t;let n=r(e);return i.set(e,n),n}return e},r=e=>{if("function"==typeof e[Symbol.iterator])return[...e].map(e=>g(e));let t={};for(let i of Reflect.ownKeys(e))t[i]=g(e[i]);return t},n);class iE extends c{load(e){e.onPlan((e,t)=>{self.postMessage({kind:"plan",options:iD(e),result:iD(t)})})}}class i$ extends ik{constructor(){super(),this.register(iE)}}export{i$ as Container,ie as ContainerModule,h as LazyServiceIdentifier,em as bindingScopeValues,eb as bindingTypeValues,eD as decorate,eq as inject,eJ as injectFromBase,eQ as injectFromHierarchy,eW as injectable,eY as multiInject,e1 as named,e3 as optional,e4 as postConstruct,e5 as preDestroy,e6 as tagged,e9 as unmanaged};